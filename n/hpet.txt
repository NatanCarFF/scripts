# Script para verificar e gerenciar o uso do HPET no Windows
# Autor: Natanael Carvalho da Silva

# Verifica status atual do HPET
$status = bcdedit /enum | Select-String "useplatformclock"

if ($status) {
    Write-Host "‚öôÔ∏è Status atual do HPET:"
    Write-Host $status.ToString()
} else {
    Write-Host "‚öôÔ∏è O HPET n√£o est√° configurado explicitamente (Windows decide automaticamente)."
}

# Pergunta se o usu√°rio deseja alterar
$opcao = Read-Host "`nDeseja (1) Ativar, (2) Desativar ou (3) Sair?"

switch ($opcao) {
    "1" {
        Write-Host "üîµ Ativando HPET..."
        Start-Process "bcdedit" -ArgumentList "/set useplatformclock true" -Verb RunAs
        Write-Host "‚úÖ HPET foi ativado. Reinicie o PC para aplicar."
    }
    "2" {
        Write-Host "üü† Desativando HPET..."
        Start-Process "bcdedit" -ArgumentList "/deletevalue useplatformclock" -Verb RunAs
        Write-Host "‚úÖ HPET foi desativado (Windows escolher√° automaticamente). Reinicie o PC para aplicar."
    }
    "3" {
        Write-Host "‚ùå Saindo sem altera√ß√µes."
    }
    default {
        Write-Host "Op√ß√£o inv√°lida."
    }
}
