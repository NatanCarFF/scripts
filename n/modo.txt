# Script: Ativar/Desativar Modo de Jogo do Windows
# Autor: Natanael (adaptado por ChatGPT)

Write-Host "üéÆ Gerenciador do Modo de Jogo do Windows" -ForegroundColor Cyan

# L√™ o estado atual
$chave = "HKCU:\Software\Microsoft\GameBar"
$valor = Get-ItemProperty -Path $chave -Name "AllowAutoGameMode" -ErrorAction SilentlyContinue

if ($valor.AllowAutoGameMode -eq 1) {
    Write-Host "‚úÖ O Modo de Jogo est√° ATIVADO." -ForegroundColor Green
} elseif ($valor.AllowAutoGameMode -eq 0) {
    Write-Host "‚ùå O Modo de Jogo est√° DESATIVADO." -ForegroundColor Red
} else {
    Write-Host "‚ö†Ô∏è O Modo de Jogo ainda n√£o est√° configurado." -ForegroundColor Yellow
}

# Pergunta ao usu√°rio
$opcao = Read-Host "`nDigite (1) para Ativar, (2) para Desativar, (3) para Sair"

switch ($opcao) {
    "1" {
        Set-ItemProperty -Path $chave -Name "AllowAutoGameMode" -Value 1 -Type DWord
        Write-Host "üéÆ Modo de Jogo ATIVADO com sucesso." -ForegroundColor Green
    }
    "2" {
        Set-ItemProperty -Path $chave -Name "AllowAutoGameMode" -Value 0 -Type DWord
        Write-Host "üõë Modo de Jogo DESATIVADO." -ForegroundColor Red
    }
    "3" {
        Write-Host "‚ùå Saindo sem altera√ß√µes."
    }
    Default {
        Write-Host "Op√ß√£o inv√°lida."
    }
}
